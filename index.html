<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L√âO KAZAMA | ULTRA INTELLIGENCE 2026</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        :root { --neon: #00ffcc; --bg: #0a0a0a; --side: #111; }
        body { background: var(--bg); color: #fff; font-family: 'Segoe UI', sans-serif; margin: 0; display: flex; height: 100vh; overflow: hidden; }
        
        /* Painel Lateral */
        .sidebar { width: 350px; background: var(--side); border-right: 2px solid var(--neon); padding: 20px; display: flex; flex-direction: column; gap: 10px; box-shadow: 5px 0 15px rgba(0,0,0,0.5); }
        .logo { text-align: center; font-size: 22px; font-weight: 900; color: var(--neon); letter-spacing: 2px; margin-bottom: 10px; text-shadow: 0 0 10px var(--neon); }
        
        /* Player Area */
        .main-content { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 20px; position: relative; }
        .video-container { width: 100%; max-width: 960px; aspect-ratio: 16/9; background: #000; border-radius: 20px; border: 2px solid #222; overflow: hidden; box-shadow: 0 0 40px rgba(0,255,204,0.1); }
        video { width: 100%; height: 100%; }

        /* Controles e Inputs */
        input, button { width: 100%; padding: 12px; border-radius: 10px; border: none; font-size: 14px; outline: none; transition: 0.3s; }
        input { background: #1a1a1a; color: #fff; border: 1px solid #333; }
        input:focus { border-color: var(--neon); }
        
        .btn-capture { background: var(--neon); color: #000; font-weight: bold; cursor: pointer; text-transform: uppercase; }
        .btn-capture:hover { filter: brightness(1.2); transform: scale(1.02); }
        
        .quick-links { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 10px; }
        .btn-small { background: #222; color: #aaa; font-size: 11px; padding: 8px; border: 1px solid #333; cursor: pointer; }
        .btn-small:hover { border-color: var(--neon); color: var(--neon); }

        /* Lista de Canais */
        #channelList { flex-grow: 1; overflow-y: auto; margin-top: 15px; padding-right: 5px; }
        .channel-item { padding: 12px; border-bottom: 1px solid #1a1a1a; cursor: pointer; display: flex; align-items: center; gap: 12px; border-radius: 8px; transition: 0.2s; }
        .channel-item:hover { background: #1a1a1a; transform: translateX(5px); }
        .channel-item img { width: 45px; height: 45px; object-fit: contain; background: #000; border-radius: 5px; }
        .channel-name { font-size: 13px; font-weight: 500; }

        #status { font-size: 11px; text-align: center; color: var(--neon); min-height: 15px; }
        ::-webkit-scrollbar { width: 5px; }
        ::-webkit-scrollbar-thumb { background: var(--neon); border-radius: 10px; }
    </style>
</head>
<body>

<div class="sidebar">
    <div class="logo">L√âO KAZAMA VIP</div>
    <div id="status">SISTEMA AGUARDANDO...</div>

    <div class="quick-links">
        <button class="btn-small" onclick="fastLoad('pluto')">PLUTO TV BR</button>
        <button class="btn-small" onclick="fastLoad('samsung')">SAMSUNG TV</button>
        <button class="btn-small" onclick="fastLoad('iptvorg')">CANAIS ABERTOS</button>
        <button class="btn-small" onclick="location.reload()">LIMPAR TUDO</button>
    </div>

    <input type="text" id="urlInput" placeholder="Cole URL M3U8 ou IP Shodan...">
    <button class="btn-capture" onclick="smartCapture()">Capturar Canais</button>
    
    <input type="text" id="searchBox" placeholder="üîç Filtrar por nome..." onkeyup="filterChannels()" style="margin-top: 10px;">

    <div id="channelList">
        <p style="text-align: center; color: #555; font-size: 12px; margin-top: 20px;">Nenhuma lista carregada.</p>
    </div>
</div>

<div class="main-content">
    <div class="video-container">
        <video id="videoPlayer" controls autoplay></video>
    </div>
    <div id="nowPlaying" style="margin-top: 20px; font-weight: bold; color: var(--neon);"></div>
</div>

<script>
    const video = document.getElementById('videoPlayer');
    const status = document.getElementById('st');
    let hls = new Hls();
    let currentChannels = [];

    // URLs Oficiais Blindadas
    const fastLinks = {
        pluto: 'https://i.mjh.nz/PlutoTV/br.m3u8',
        samsung: 'https://i.mjh.nz/SamsungTVPlus/br.m3u8',
        iptvorg: 'https://iptv-org.github.io/iptv/countries/br.m3u'
    };

    function fastLoad(key) {
        document.getElementById('urlInput').value = fastLinks[key];
        smartCapture();
    }

    async function smartCapture() {
        let url = document.getElementById('urlInput').value.trim();
        if (!url) return;

        // Corre√ß√£o Autom√°tica de links do GitHub (Blob -> Raw)
        if (url.includes("github.com") && !url.includes("raw.githubusercontent")) {
            url = url.replace("github.com", "raw.githubusercontent.com").replace("/blob/", "/");
        }

        document.getElementById('status').innerText = "AUTENTICANDO E VARRENDO...";
        
        // Sistema Multi-Proxy (Tenta 3 caminhos diferentes se o alvo bloquear)
        const proxyList = [
            `https://api.allorigins.win/get?url=${encodeURIComponent(url)}`,
            `https://corsproxy.io/?${encodeURIComponent(url)}`,
            `https://thingproxy.freeboard.io/fetch/${url}`
        ];

        let content = null;
        for (let p of proxyList) {
            try {
                const res = await fetch(p);
                const data = await res.json();
                content = data.contents || data;
                if (content && content.includes("#EXTM3U")) break;
            } catch (e) { console.warn("Proxy falhou, tentando o pr√≥ximo..."); }
        }

        if (content && content.includes("#EXTM3U")) {
            parseM3U(content);
        } else {
            document.getElementById('status').innerText = "ERRO: LISTA INV√ÅLIDA OU BLOQUEADA.";
            alert("O servidor n√£o respondeu. Tente os bot√µes da Pluto TV.");
        }
    }

    function parseM3U(data) {
        const lines = data.split('\n');
        currentChannels = [];
        
        for (let i = 0; i < lines.length; i++) {
            if (lines[i].includes('#EXTINF')) {
                const info = lines[i];
                const name = info.split(',')[1]?.trim() || "Canal VIP";
                const logo = info.match(/tvg-logo="([^"]+)"/)?.[1] || "";
                
                let link = "";
                for (let j = i + 1; j < i + 5; j++) {
                    if (lines[j]?.trim().startsWith('http')) {
                        link = lines[j].trim();
                        break;
                    }
                }
                
                if (link) currentChannels.push({ name, logo, link });
            }
        }
        renderChannels(currentChannels);
        document.getElementById('status').innerText = `${currentChannels.length} CANAIS SINCRONIZADOS`;
    }

    function renderChannels(list) {
        const container = document.getElementById('channelList');
        container.innerHTML = "";
        
        list.forEach(item => {
            const div = document.createElement('div');
            div.className = 'channel-item';
            div.innerHTML = `
                <img src="${item.logo || 'https://via.placeholder.com/45/000/00ffcc?text=TV'}" onerror="this.src='https://via.placeholder.com/45/000/00ffcc?text=TV'">
                <div class="channel-name">${item.name}</div>
            `;
            div.onclick = () => playStream(item.link, item.name);
            container.appendChild(div);
        });
    }

    function playStream(url, name) {
        document.getElementById('nowPlaying').innerText = "üì° TRANSMITINDO: " + name;
        if (Hls.isSupported()) {
            hls.destroy();
            hls = new Hls();
            hls.loadSource(url);
            hls.attachMedia(video);
            hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
        } else {
            video.src = url;
            video.play();
        }
    }

    function filterChannels() {
        const query = document.getElementById('searchBox').value.toLowerCase();
        const filtered = currentChannels.filter(c => c.name.toLowerCase().includes(query));
        renderChannels(filtered);
    }
</script>
</body>
</html>
