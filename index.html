function toggleCanais() {
    const menu = document.getElementById('menu-canais');
    menu.style.display = (menu.style.display === 'block') ? 'none' : 'block';
}

function playM3U8(url, nome) {
    const video = document.getElementById('video');
    const container = document.getElementById('video-container');
    
    // PROTEÇÃO ATIVA: Usamos um proxy para evitar bloqueio de CORS e HTTPS
    // Isso "limpa" o sinal antes de chegar no seu player em Uberlândia
    const proxyUrl = "https://api.allorigins.win/raw?url=";
    const urlProtegida = url.startsWith('http://') ? proxyUrl + encodeURIComponent(url) : url;

    container.style.display = 'block';
    console.log("Sistema Léo Kasama: Proteção ativada para " + nome);

    if (Hls.isSupported()) {
        const hls = new Hls({
            xhrSetup: function (xhr, url) {
                xhr.withCredentials = false; // Remove rastreio para evitar bloqueios
            }
        });
        hls.loadSource(urlProtegida);
        hls.attachMedia(video);
        hls.on(Hls.Events.MANIFEST_PARSED, function() {
            video.play().catch(() => {
                console.log("Aguardando interação do usuário para Play.");
            });
        });

        // Recuperação automática em caso de erro de sinal
        hls.on(Hls.Events.ERROR, function (event, data) {
            if (data.fatal) {
                switch (data.type) {
                    case Hls.ErrorTypes.NETWORK_ERROR:
                        hls.startLoad();
                        break;
                    case Hls.ErrorTypes.MEDIA_ERROR:
                        hls.recoverMediaError();
                        break;
                    default:
                        hls.destroy();
                        break;
                }
            }
        });
    } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
        video.src = url;
    }
    
    container.scrollIntoView({ behavior: 'smooth' });
}

function acao(tipo) {
    console.log("Comando: " + tipo);
    // As outras categorias podem ser adicionadas aqui com a mesma proteção
}
